<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QCK API Documentation</title>
    <link rel="stylesheet" href="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui.css" />
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        #swagger-ui {
            max-width: 1460px;
            margin: 0 auto;
            padding: 20px;
        }
        .topbar {
            display: none;
        }
        .swagger-ui .info {
            margin: 50px 0;
        }
        .swagger-ui .info .title {
            color: #3b4151;
        }
        .swagger-ui .btn.execute {
            background-color: #4990e2;
            border-color: #4990e2;
        }
        .swagger-ui .btn.execute:hover {
            background-color: #1268c3;
            border-color: #1268c3;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 600;
        }
        .header p {
            margin: 0.5rem 0 0;
            opacity: 0.9;
            font-size: 1.1rem;
        }
        .quick-test {
            background: #f7f8fa;
            border-radius: 8px;
            padding: 20px;
            margin: 20px auto;
            max-width: 1460px;
        }
        .quick-test h2 {
            color: #3b4151;
            margin-top: 0;
        }
        .quick-test pre {
            background: #282c34;
            color: #abb2bf;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
        }
        .endpoint-info {
            background: white;
            border-left: 4px solid #4990e2;
            padding: 15px;
            margin: 20px auto;
            max-width: 1460px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .endpoint-info h3 {
            margin-top: 0;
            color: #3b4151;
        }
        .endpoint-info code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            color: #e83e8c;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üöÄ QCK Backend API</h1>
        <p>User Registration & Authentication API Documentation</p>
    </div>

    <div class="endpoint-info">
        <h3>üìç Base URLs</h3>
        <p><strong>Development:</strong> <code>http://localhost:8080/api/v1</code></p>
        <p><strong>Production:</strong> <code>https://api.qck.sh/v1</code></p>
    </div>

    <div class="quick-test">
        <h2>üß™ Quick Test - Registration Endpoint</h2>
        <p>Copy and paste this command in your terminal to test the registration endpoint:</p>
        <pre>curl -X POST http://localhost:8080/v1/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "SecureP@ssw0rd123!",
    "password_confirmation": "SecureP@ssw0rd123!",
    "full_name": "Test User",
    "company_name": "Test Company",
    "accept_terms": true
  }'</pre>
    </div>

    <div id="swagger-ui"></div>

    <script src="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-bundle.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-standalone-preset.js"></script>
    <script>
        window.onload = function() {
            // The OpenAPI spec content
            const spec = {
                openapi: '3.0.3',
                info: {
                    title: 'QCK Authentication API',
                    description: 'User registration and authentication endpoints for QCK URL shortener platform',
                    version: '1.0.0',
                    contact: {
                        name: 'QCK Development Team',
                        email: 'dev@qck.sh'
                    }
                },
                servers: [
                    {
                        url: 'http://localhost:8080/api/v1',
                        description: 'Development server'
                    },
                    {
                        url: 'https://api.qck.sh/v1',
                        description: 'Production server'
                    }
                ],
                paths: {
                    '/auth/register': {
                        post: {
                            tags: ['Authentication'],
                            summary: 'Register a new user account',
                            description: 'Creates a new user account with email and password authentication.\n\n**Requirements:**\n- Password must be at least 8 characters\n- Password must contain uppercase, lowercase, number, and special character\n- Email must be unique (case-insensitive)\n- Terms and conditions must be accepted\n\n**Rate Limiting:**\n- 5 requests per minute per IP address\n\n**Email Verification:**\n- New accounts require email verification\n- Verification email sent automatically after registration',
                            operationId: 'registerUser',
                            requestBody: {
                                required: true,
                                content: {
                                    'application/json': {
                                        schema: {
                                            $ref: '#/components/schemas/RegisterRequest'
                                        },
                                        examples: {
                                            valid: {
                                                summary: 'Valid registration request',
                                                value: {
                                                    email: 'user@example.com',
                                                    password: 'SecureP@ssw0rd123!',
                                                    password_confirmation: 'SecureP@ssw0rd123!',
                                                    full_name: 'John Doe',
                                                    company_name: 'Acme Corp',
                                                    accept_terms: true
                                                }
                                            },
                                            weakPassword: {
                                                summary: 'Weak password example',
                                                value: {
                                                    email: 'user@example.com',
                                                    password: 'weak',
                                                    password_confirmation: 'weak',
                                                    full_name: 'John Doe',
                                                    company_name: null,
                                                    accept_terms: true
                                                }
                                            }
                                        }
                                    }
                                }
                            },
                            responses: {
                                '201': {
                                    description: 'User successfully registered',
                                    content: {
                                        'application/json': {
                                            schema: {
                                                $ref: '#/components/schemas/RegisterSuccessResponse'
                                            },
                                            example: {
                                                success: true,
                                                data: {
                                                    user_id: '550e8400-e29b-41d4-a716-446655440000',
                                                    email: 'user@example.com',
                                                    full_name: 'John Doe',
                                                    company_name: 'Acme Corp',
                                                    email_verification_required: true,
                                                    verification_sent: true,
                                                    message: 'Registration successful! Please check your email for a 6-digit verification code.'
                                                },
                                                message: 'User registered successfully'
                                            }
                                        }
                                    }
                                },
                                '400': {
                                    description: 'Bad Request - Validation failed',
                                    content: {
                                        'application/json': {
                                            schema: {
                                                $ref: '#/components/schemas/ErrorResponse'
                                            },
                                            examples: {
                                                passwordMismatch: {
                                                    summary: "Passwords don't match",
                                                    value: {
                                                        success: false,
                                                        data: null,
                                                        message: 'Passwords do not match'
                                                    }
                                                },
                                                invalidEmail: {
                                                    summary: 'Invalid email format',
                                                    value: {
                                                        success: false,
                                                        data: null,
                                                        message: 'email: Invalid email format'
                                                    }
                                                },
                                                weakPassword: {
                                                    summary: "Password doesn't meet requirements",
                                                    value: {
                                                        success: false,
                                                        data: null,
                                                        message: 'password: password_complexity'
                                                    }
                                                },
                                                termsNotAccepted: {
                                                    summary: 'Terms not accepted',
                                                    value: {
                                                        success: false,
                                                        data: null,
                                                        message: 'You must accept the terms and conditions'
                                                    }
                                                }
                                            }
                                        }
                                    }
                                },
                                '409': {
                                    description: 'Conflict - Email already exists',
                                    content: {
                                        'application/json': {
                                            schema: {
                                                $ref: '#/components/schemas/ErrorResponse'
                                            },
                                            example: {
                                                success: false,
                                                data: null,
                                                message: 'An account with this email address already exists'
                                            }
                                        }
                                    }
                                },
                                '429': {
                                    description: 'Too Many Requests - Rate limit exceeded',
                                    content: {
                                        'application/json': {
                                            schema: {
                                                $ref: '#/components/schemas/ErrorResponse'
                                            },
                                            example: {
                                                success: false,
                                                data: null,
                                                message: 'Too many registration attempts. Please try again in 60 seconds'
                                            }
                                        }
                                    }
                                },
                                '500': {
                                    description: 'Internal Server Error',
                                    content: {
                                        'application/json': {
                                            schema: {
                                                $ref: '#/components/schemas/ErrorResponse'
                                            },
                                            example: {
                                                success: false,
                                                data: null,
                                                message: 'Failed to create user account'
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                components: {
                    schemas: {
                        RegisterRequest: {
                            type: 'object',
                            required: ['email', 'password', 'password_confirmation', 'full_name', 'accept_terms'],
                            properties: {
                                email: {
                                    type: 'string',
                                    format: 'email',
                                    maxLength: 320,
                                    description: "User's email address (will be stored in lowercase)",
                                    example: 'user@example.com'
                                },
                                password: {
                                    type: 'string',
                                    format: 'password',
                                    minLength: 8,
                                    description: 'Password must contain:\n- At least 8 characters\n- At least one uppercase letter\n- At least one lowercase letter\n- At least one number\n- At least one special character',
                                    example: 'SecureP@ssw0rd123!'
                                },
                                password_confirmation: {
                                    type: 'string',
                                    format: 'password',
                                    description: 'Must match the password field exactly',
                                    example: 'SecureP@ssw0rd123!'
                                },
                                full_name: {
                                    type: 'string',
                                    minLength: 1,
                                    maxLength: 255,
                                    description: "User's full name",
                                    example: 'John Doe'
                                },
                                company_name: {
                                    type: 'string',
                                    maxLength: 255,
                                    nullable: true,
                                    description: "User's company name (optional)",
                                    example: 'Acme Corp'
                                },
                                accept_terms: {
                                    type: 'boolean',
                                    description: 'User must accept terms and conditions',
                                    example: true
                                }
                            }
                        },
                        RegisterResponse: {
                            type: 'object',
                            required: ['user_id', 'email', 'full_name', 'email_verification_required', 'verification_sent', 'message'],
                            properties: {
                                user_id: {
                                    type: 'string',
                                    format: 'uuid',
                                    description: 'Unique identifier for the created user',
                                    example: '550e8400-e29b-41d4-a716-446655440000'
                                },
                                email: {
                                    type: 'string',
                                    format: 'email',
                                    description: 'The registered email address',
                                    example: 'user@example.com'
                                },
                                full_name: {
                                    type: 'string',
                                    description: "User's full name",
                                    example: 'John Doe'
                                },
                                company_name: {
                                    type: 'string',
                                    nullable: true,
                                    description: "User's company name",
                                    example: 'Acme Corp'
                                },
                                email_verification_required: {
                                    type: 'boolean',
                                    description: 'Whether email verification is required',
                                    example: true
                                },
                                verification_sent: {
                                    type: 'boolean',
                                    description: 'Whether verification email was sent',
                                    example: true
                                },
                                message: {
                                    type: 'string',
                                    description: 'User-friendly success message',
                                    example: 'Registration successful! Please check your email for a 6-digit verification code.'
                                }
                            }
                        },
                        RegisterSuccessResponse: {
                            type: 'object',
                            required: ['success', 'data', 'message'],
                            properties: {
                                success: {
                                    type: 'boolean',
                                    example: true
                                },
                                data: {
                                    $ref: '#/components/schemas/RegisterResponse'
                                },
                                message: {
                                    type: 'string',
                                    example: 'User registered successfully'
                                }
                            }
                        },
                        ErrorResponse: {
                            type: 'object',
                            required: ['success', 'data', 'message'],
                            properties: {
                                success: {
                                    type: 'boolean',
                                    example: false
                                },
                                data: {
                                    type: 'object',
                                    nullable: true,
                                    example: null
                                },
                                message: {
                                    type: 'string',
                                    description: 'Error message describing what went wrong',
                                    example: 'An account with this email address already exists'
                                }
                            }
                        }
                    }
                },
                tags: [
                    {
                        name: 'Authentication',
                        description: 'User authentication and registration endpoints'
                    }
                ]
            };

            // Initialize Swagger UI
            const ui = SwaggerUIBundle({
                spec: spec,
                dom_id: '#swagger-ui',
                deepLinking: true,
                presets: [
                    SwaggerUIBundle.presets.apis,
                    SwaggerUIStandalonePreset
                ],
                plugins: [
                    SwaggerUIBundle.plugins.DownloadUrl
                ],
                layout: "StandaloneLayout",
                defaultModelsExpandDepth: 1,
                defaultModelExpandDepth: 1,
                docExpansion: "list",
                filter: true,
                showExtensions: true,
                showCommonExtensions: true,
                tryItOutEnabled: true,
                supportedSubmitMethods: ['get', 'post', 'put', 'delete', 'patch'],
                onComplete: function() {
                    console.log("Swagger UI loaded successfully");
                }
            });

            window.ui = ui;
        }
    </script>
</body>
</html>
